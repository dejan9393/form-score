{"version":3,"file":"sign-here.js","sourceRoot":"","sources":["../../../src/elements/sign-here.ts"],"names":[],"mappings":"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","sourcesContent":["import {customElement, property} from \"lit/decorators.js\";\nimport {html, LitElement, PropertyValues} from \"lit\";\nimport SignaturePad from 'signature_pad';\n\n@customElement('sign-here')\nexport class SignHere extends LitElement {\n  /**\n   * Width of the signature pad in pixels\n   */\n  @property({type: Number})\n  width = 360;\n\n  /**\n   * Height of the signature pad in pixels\n   */\n  @property({type: Number})\n  height = 180;\n\n  /**\n   * Radius of a single dot\n   */\n  @property({type: Number})\n  dotSize = 0;\n\n  /**\n   * Minimum width of a line. Defaults to 0.5\n   */\n  @property({type: Number})\n  minWidth = 0.5;\n\n  /**\n   * Maximum width of a line. Defaults to 2.5\n   */\n  @property({type: Number})\n  maxWidth = 2.5;\n\n  /**\n   * Draw the next point at most once per every x milliseconds.\n   * Set it to 0 to turn off throttling.\n   * Defaults to 16.\n   */\n  @property({type: Number})\n  throttle = 16;\n\n  /**\n   * Add the next point only if the previous one is farther than x pixels.\n   * Defaults to 5.\n   */\n  @property({type: Number})\n  minDistance = 5;\n\n  /**\n   * Color used to clear the background.\n   * Can be any color format accepted by context.fillStyle.\n   * Defaults to \"rgba(0,0,0,0)\" (transparent black).\n   * Use a non-transparent color e.g. \"rgb(255,255,255)\" (opaque white)\n   * if you'd like to save signatures as JPEG images.\n   */\n  @property({type: String})\n  backgroundColor = 'rgb(255, 255, 255)';\n\n  /**\n   * Color used to draw the lines.\n   * Can be any color format accepted by context.fillStyle.\n   * Defaults to \"black\".\n   */\n  @property({type: String})\n  penColor = 'rgb(0, 0, 0)';\n\n  /**\n   * Weight used to modify new velocity based on the previous velocity. Defaults to 0.7\n   */\n  @property({type: Number})\n  velocityFilterWeight = 0.7;\n\n  /**\n   * toDataUrl encoding format\n   */\n  @property({type: String})\n  type = 'image/png';\n\n  /**\n   * toDataUrl encoding image quality between 0 and 1\n   */\n  @property({type: Number})\n  encoderOptions = 0.85;\n\n  /**\n   * Data uri encoded image data\n   */\n  @property({type: String})\n  image = '';\n\n  /**\n   * Indicates if the signature pad is currently active\n   */\n  @property({type: Boolean, state: true})\n  protected active = false;\n\n  protected signaturePad: any;\n\n  render() {\n    return html`\n      <canvas id=\"canvas\" part=\"canvas\"></canvas>`;\n  }\n\n  willUpdate(changedProps: PropertyValues) {\n    super.willUpdate(changedProps);\n\n    const signaturePadProperties = [\n      'dotSize',\n      'minWidth',\n      'maxWidth',\n      'backgroundColor',\n      'penColor',\n      'velocityFilterWeight',\n    ];\n\n    const dimensionProps = [\n      'width',\n      'height',\n    ];\n\n    if (!this.signaturePad) {\n      return;\n    }\n\n    signaturePadProperties.forEach(prop => {\n      if (!changedProps.has(prop)) {\n        return;\n      }\n\n      this.signaturePad[prop] = changedProps.get(prop);\n    });\n\n    dimensionProps.forEach(prop => {\n      if (!changedProps.has(prop)) {\n        return;\n      }\n\n      this.setCanvasDimensions();\n    })\n\n    if (changedProps.has('type') || changedProps.has('encoderOptions')) {\n      this.encodeImage();\n    }\n  }\n\n  get empty() {\n    return this.signaturePad.isEmpty();\n  }\n\n  get canvas() {\n    return this.shadowRoot!.querySelector('#canvas') as HTMLCanvasElement;\n  }\n\n  protected firstUpdated(changedProps: PropertyValues) {\n    super.firstUpdated(changedProps);\n\n    this.setCanvasDimensions();\n\n    this.signaturePad = new SignaturePad(this.canvas, {\n      dotSize: this.dotSize,\n      minWidth: this.minWidth,\n      maxWidth: this.maxWidth,\n      backgroundColor: this.backgroundColor,\n      penColor: this.penColor,\n      velocityFilterWeight: this.velocityFilterWeight,\n    });\n\n    this.signaturePad.addEventListener('beginStroke', () =>\n      this.active = true\n    );\n\n    this.signaturePad.addEventListener('endStroke', () =>\n      this.active = false\n    );\n\n    this.signaturePad.clear();\n\n    if (this.image) {\n      this.signaturePad.fromDataURL(this.image);\n    }\n  }\n\n  setCanvasDimensions() {\n    const ratio = Math.max(window.devicePixelRatio || 1, 1);\n\n    const canvas = this.canvas;\n    canvas.style.width = this.width + 'px';\n    canvas.style.height = this.height + 'px';\n    canvas.width = this.width * ratio;\n    canvas.height = this.height * ratio;\n    canvas.getContext(\"2d\")!.scale(ratio, ratio);\n\n    this.clear();\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    if (this.signaturePad) {\n      this.signaturePad.on();\n    }\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n\n    this.signaturePad.off();\n  }\n\n  /**\n   * Clears the image\n   */\n  clear() {\n    if (!this.signaturePad) {\n      return;\n    }\n\n    this.signaturePad.clear();\n    this.encodeImage();\n  }\n\n  /**\n   * Encodes the image using the type and encoderOptions (quality) defined.\n   * The encoded image is available in the `image` property.\n   */\n  encodeImage() {\n    this.image = this.empty ? '' : this.canvas.toDataURL(this.type, this.encoderOptions);\n  }\n}\n"]}